// SVG Plugin for KUTE.js | dnp_theme | MIT License
!function(t){if("function"==typeof define&&define.amd)define(["./kute.js"],function(e){return t(e),e});else if("object"==typeof module&&"function"==typeof require){var e=require("./kute.js");module.exports=t(e)}else{if("undefined"==typeof window.KUTE)throw new Error("SVG Plugin require KUTE.js.");window.KUTE.svg=window.KUTE.svg||t(e)}}(function(t){"use strict";var e,r=window.KUTE,n=n||{},o=document.getElementsByTagName("path")[0],a=o&&o.ownerSVGElement&&o.ownerSVGElement.namespaceURI||"http://www.w3.org/2000/svg",i=["strokeWidth","strokeOpacity","fillOpacity","stopOpacity"],s=["fill","stroke","stopColor"],h=function(t){return String.prototype.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};if(!o||o.ownerSVGElement){n.getPath=function(t){var e={},r="object"==typeof t?t:/^\.|^\#/.test(t)?document.querySelector(t):null;if(r&&/path|glyph/.test(r.tagName))e.e=n.forcePath(r),e.o=r.getAttribute("d");else if(!r&&/[a-z][^a-z]*/gi.test(t)){var o=n.createPath(h(t));e.e=o,e.o=t}return e},n.pathCross=function(t){this._mpr=t.morphPrecision||25,this._midx=t.morphIndex,this._smi=t.showMorphInfo,this._rv1=t.reverseFirstPath,this._rv2=t.reverseSecondPath;var e,r=n.getOnePath(t._vS.path.o),o=n.getOnePath(t._vE.path.o);e=n._pathCross(r,o),t._vS.path.d=e[0],t._vE.path.d=e[1]},n._pathCross=function(t,e){t=n.createPath(t),e=n.createPath(e);var r,o=n.getSegments(t,e,this._mpr),a=o[0],i=o[1],s=i.length;if(this._rv1&&a.reverse(),this._rv2&&i.reverse(),this._smi&&(r=n.getBestIndex(a,i)),this._midx){var h=i.splice(this._midx,s-this._midx);i=h.concat(i)}return this._smi&&console.log("KUTE.js Path Morph Log\nThe morph used "+s+" points to draw both paths based on "+this._mpr+" morphPrecision value.\n"+(this._midx?"You've configured the morphIndex to "+this._midx+" while the recommended is "+r+".\n":"You may also consider a morphIndex for the second path. Currently the best index seems to be "+r+".\n")+(this._rv1||this._rv2?"You've chosen that the first path to have "+(this._rv1?"REVERSED draw direction, ":"UNCHANGED draw direction, ")+"while second path is to be "+(this._rv2?"REVERSED.\n":"UNCHANGED.\n"):"If the current animation is not satisfactory, consider reversing one of the paths. Maybe the paths do not intersect or they really have different draw directions.")),t=e=null,[a,i]},n.getSegments=function(t,e,r){for(var n=[],o=[],a=t.getTotalLength(),i=e.getTotalLength(),s=Math.max(a,i),h=s/r,p=0,u=h*r;(p+=r)<u;)n.push([t.getPointAtLength(p).x,t.getPointAtLength(p).y]),o.push([e.getPointAtLength(p).x,e.getPointAtLength(p).y]);return[n,o]},n.getBestIndex=function(t,e){var r,o,a,i,s=n.clone(t),h=n.clone(e),p=[],u=[],l=s.length;for(r=0;l>r;r++)o=h.splice(r,l-r),h=o.concat(h),a=Math.abs(s[r][0]-h[r][0]),i=Math.abs(s[r][1]-h[r][1]),p.push(Math.sqrt(a*a+i*i)),u.push(h),h=[],h=n.clone(e),o=null;return p.indexOf(Math.min.apply(null,p))},n.getOnePath=function(t){var e=t.split(/z/i);return e.length>2?h(e[0])+"z":h(t)},n.createPath=function(t){var e=document.createElementNS(a,"path"),r="object"==typeof t?t.getAttribute("d"):t;return e.setAttribute("d",r),e},n.forcePath=function(t){if("glyph"===t.tagName){var e=n.createPath(t);return t.parentNode.appendChild(e),e}return t},n.clone=function(t){var e;if(t instanceof Array){e=[];for(var r=0,o=t.length;o>r;r++)e[r]=n.clone(t[r]);return e}if(t instanceof Object){e={};for(var a in t)t.hasOwnProperty(a)&&(e[a]=n.clone(t[a]));return e}return t},r.pp.path=function(t,e,o){return"path"in r.dom||(r.dom.path=function(t,e,r){var n,o,a=[];for(n=0,o=t._vE.path.d.length;o>n;n++){a[n]=[];for(var i=0;2>i;i++)a[n].push(t._vS.path.d[n][i]+(t._vE.path.d[n][i]-t._vS.path.d[n][i])*r)}t._el.setAttribute("d",1===r?t._vE.path.o:"M"+a.join("L")+"Z")}),n.getPath(e)},r.prS.path=function(t,e,r){return t.getAttribute("d")},n.getDraw=function(t,e){var o,a,i,s,p=t.getTotalLength();return e instanceof Object?e:("string"==typeof e?(e=e.split(/\,|\s/),o=/%/.test(e[0])?n.percent(h(e[0]),p):parseFloat(e[0]),a=/%/.test(e[1])?n.percent(h(e[1]),p):parseFloat(e[1])):"undefined"==typeof e&&(s=parseFloat(r.gCS(t,"strokeDashoffset")),i=r.gCS(t,"strokeDasharray").split(/\,/),o=0-s,a=parseFloat(i[0])+o||p),{s:o,e:a,l:p})},n.percent=function(t,e){return parseFloat(t)/100*e},r.pp.draw=function(t,e,o){return"draw"in r.dom||(r.dom.draw=function(t,e,r){var n,o,a,i;n=t._vS.draw.l,o=t._vS.draw.s+(t._vE.draw.s-t._vS.draw.s)*r,a=t._vS.draw.e+(t._vE.draw.e-t._vS.draw.e)*r,i=0-o,t._el.style.strokeDashoffset=i+"px",t._el.style.strokeDasharray=1>a+i?"0px, "+n+"px":a+i+"px, "+n+"px"}),n.getDraw(o,e)},r.prS.draw=function(t,e,r){return n.getDraw(t)};for(var p=0,u=s.length;u>p;p++)e=s[p],r.pp[e]=function(t,e){return t in r.dom||(r.dom[t]=function(t,e,n){var o={};for(var a in t._vE[e])"a"!==a?o[a]=parseInt(t._vS[e][a]+(t._vE[e][a]-t._vS[e][a])*n)||0:o[a]=t._vS[e][a]&&t._vE[e][a]?parseFloat(t._vS[e][a]+(t._vE[e][a]-t._vS[e][a])*n):null;t._hex?t._el.style[e]=r.rth(o.r,o.g,o.b):t._el.style[e]=o.a?"rgba("+o.r+","+o.g+","+o.b+","+o.a+")":"rgb("+o.r+","+o.g+","+o.b+")"}),r.truC(e)},r.prS[e]=function(t,e,n){return r.gCS(t,e)||"rgba(0,0,0,0)"};for(var p=0,u=i.length;u>p;p++)e=i[p],"strokeWidth"===e?r.pp[e]=function(t,e){return t in r.dom||(r.dom[t]=function(t,e,r){t._el.style[e]=t._vS[e].value+(t._vE[e].value-t._vS[e].value)*r+t._vS[e].unit}),r.pp.box(t,e)}:r.pp[e]=function(t,e){return t in r.dom||(r.dom[t]=function(t,e,r){t._el.style[e]=t._vS[e].value+(t._vE[e].value-t._vS[e].value)*r}),r.pp.unl(t,e)},r.prS[e]=function(t,e,n){return r.gCS(t,e)||0};return n}});