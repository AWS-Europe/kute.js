!function(t){if("function"==typeof define&&define.amd)define(["./kute.js"],function(e){return t(e),e});else if("object"==typeof module&&"function"==typeof require){var e=require("./kute.js");module.exports=t(e)}else{if("undefined"==typeof window.KUTE)throw new Error("SVG Plugin require KUTE.js.");window.KUTE.svg=window.KUTE.svg||t(e)}}(function(t){"use strict";var e,r=window.KUTE,n=r.svg={},s=r.dom,i=r.pp,a=document.querySelector("path")||document.querySelector("svg"),o=a&&a.ownerSVGElement&&a.ownerSVGElement.namespaceURI||"http://www.w3.org/2000/svg",h=["strokeWidth","strokeOpacity","fillOpacity","stopOpacity"],p=["fill","stroke","stopColor"],l=/(m[^(h|v|l)]*|[vhl][^(v|h|l|z)]*)/gim,u=r.Interpolate.number,f=r.Interpolate.color,g=function(t,e,r,n){var s,i=[];for(s=0;s<r;s++)i.push(t[s]===e[s]?e[s]:u(t[s],e[s],n));return i},c=function(t,e,r,n,s,i){var a,o=[];for(a=0;a<r;a++)o.push(g(t[a],e[a],n,i));return o.join(s)};if(!a||a.ownerSVGElement){n.gPt=function(t){var e={},r="object"==typeof t?t:/^\.|^\#/.test(t)?document.querySelector(t):null;return r&&/path|glyph/.test(r.tagName)?(e.e=n.fPt(r),e.o=r.getAttribute("d")):!r&&/[a-z][^a-z]*/gi.test(t)&&(e.e=n.cP(t.trim()),e.o=t),e},n.pCr=function(t){this._mpr=t._ops.morphPrecision||15,this._midx=t._ops.morphIndex,this._smi=t._ops.showMorphInfo,this._rv1=t._ops.reverseFirstPath,this._rv2=t._ops.reverseSecondPath;var e,r=n.gOp(t._vS.path.o),s=n.gOp(t._vE.path.o);this._isp=!/[CSQTA]/i.test(r)&&!/[CSQTA]/i.test(s),e=n._pCr(r,s,t._el.parentNode),t._vS.path.d=e[0],t._vE.path.d=e[1]},n._pCr=function(t,e,r){var s,i,a,o,h,p,l,u,f,g,c,v,d=[];if(this._sp=!1,this._isp)if(t=n.pTA(t),e=n.pTA(e),t.length!==e.length){h=Math.max(t.length,e.length),h===e.length?(p=t,l=e):(p=e,l=t),f=p.length,u=n.cP("M"+p.join("L")+"z"),g=u.getTotalLength()/h;for(var m=0;m<h;m++)c=u.getPointAtLength(g*m),v=n.gCP(g,c,p),d.push([v[0],v[1]]);h===e.length?(i=l,s=d):(s=l,i=d)}else s=t,i=e;else t=n.cP(t),e=n.cP(e),a=n.gSegs(t,e,this._mpr),s=a[0],i=a[1],h=i.length;if(this._rv1&&s.reverse(),this._rv2&&i.reverse(),this._smi&&(o=n.gBi(s,i)),this._midx){var _=i.splice(this._midx,h-this._midx);i=_.concat(i)}if(this._smi){n.shP(s,i,r);var y=this._isp?"the polygon with the most points.\n":(25===this._mpr?"the default":"your")+" morphPrecision value of "+this._mpr+".\n";console.log("KUTE.js Path Morph Log\nThe morph used "+h+" points to draw both paths based on "+y+(this._midx?"You've configured the morphIndex to "+this._midx+" while the recommended is "+o+".\n":"You may also consider a morphIndex for the second path. Currently the best index seems to be "+o+".\n")+(this._rv1||this._rv2?"You've chosen that the first path to have "+(this._rv1?"REVERSED draw direction, ":"UNCHANGED draw direction, ")+"while second path is to be "+(this._rv2?"REVERSED.\n":"UNCHANGED.\n"):"If the current animation is not satisfactory, consider reversing one of the paths. Maybe the paths do not intersect or they really have different draw directions."))}return t=e=null,[s,i]},n.gSegs=function(t,e,r){for(var n=[],s=[],i=t.getTotalLength(),a=e.getTotalLength(),o=Math.max(i,a),h=o/r,p=0,l=h*r;(p+=r)<l;)n.push([t.getPointAtLength(p).x,t.getPointAtLength(p).y]),s.push([e.getPointAtLength(p).x,e.getPointAtLength(p).y]);return[n,s]},n.gCP=function(t,e,r){var n,s,i,a,o,h=[],p=r.length;for(v=0;v<p;v++)n=Math.abs(r[v][0]-e.x),s=Math.abs(r[v][1]-e.y),h.push(Math.sqrt(n*n+s*s));return i=h.indexOf(Math.min.apply(null,h)),o=r[i-1]?i-1:p-1,a=r[i+1]?i+1:0,Math.abs(r[o][0]-e.x)<t&&Math.abs(r[o][1]-e.y)<t?r[o]:Math.abs(r[a][0]-e.x)<t&&Math.abs(r[a][1]-e.y)<t?r[a]:Math.abs(r[i][0]-e.x)<t&&Math.abs(r[i][1]-e.y)<t?r[i]:[e.x,e.y]},n.shP=function(t,e,r){if(!this._sp){for(var n,s,i,a,h=arguments,p=0;p<2;p++){i=h[p],a=i.length,s=0===p?{f:"DeepPink",o:"HotPink"}:{f:"Lime",o:"LimeGreen"};for(var l=0;l<a;l++)n=document.createElementNS(o,"circle"),n.setAttribute("cx",i[l][0]),n.setAttribute("cy",i[l][1]),n.setAttribute("r",0===l?20:10),n.setAttribute("fill",0===l?s.f:s.o),this._isp?r.appendChild(n):this._isp||0!==l||r.appendChild(n)}this._sp=!0,n=null}},n.gBi=function(t,e){var r,s,i,a,o=n.clone(t),h=n.clone(e),p=[],l=e.length;for(r=0;r<l;r++)s=h.splice(r,l-r),h=s.concat(h),i=Math.abs(o[r][0]-h[r][0]),a=Math.abs(o[r][1]-h[r][1]),p.push(Math.sqrt(i*i+a*a)),h=[],h=n.clone(e),s=null;return p.indexOf(Math.min.apply(null,p))},n.gOp=function(t){return t.split(/z/i).shift()+"z"},n.cP=function(t){var e=document.createElementNS(o,"path"),r="object"==typeof t?t.getAttribute("d"):t;return e.setAttribute("d",r),e},n.fPt=function(t){if("glyph"===t.tagName){var e=n.cP(t);return t.parentNode.appendChild(e),e}return t},n.clone=function(t){var e;if(t instanceof Array){e=[];for(var r=0,s=t.length;r<s;r++)e[r]=n.clone(t[r]);return e}return t},n.pTA=function(t){for(var e,r,n=t.match(l),s=n.length,i=0,a=0,o=0;o<s;o++)n[o]=n[o],e=n[o][0],r=new RegExp(e+"[^\\d|\\-]*","i"),n[o]=n[o].replace(/(^|[^,])\s*-/g,"$1,-").replace(/(\s+\,|\s|\,)/g,",").replace(r,"").split(","),n[o][0]=parseFloat(n[o][0]),n[o][1]=parseFloat(n[o][1]),0===o?(i+=n[o][0],a+=n[o][1]):(i=n[o-1][0],a=n[o-1][1],/l/i.test(e)?(n[o][0]="l"===e?n[o][0]+i:n[o][0],n[o][1]="l"===e?n[o][1]+a:n[o][1]):/h/i.test(e)?(n[o][0]="h"===e?n[o][0]+i:n[o][0],n[o][1]=a):/v/i.test(e)&&(n[o][0]=i,n[o][1]="v"===e?n[o][0]+a:n[o][0]));return n},r.svq=function(t){t._vE.path&&n.pCr(t),t._vE.svgTransform&&n.sT(t)},r.pp.path=function(t,e,r){return"path"in s||(s.path=function(t,e,r,n,s){t.setAttribute("d",1===s?n.o:"M"+c(r.d,n.d,n.d.length,2,"L",s)+"Z")}),n.gPt(e)},r.prS.path=function(t,e,r){return t.getAttribute("d")},n.gDr=function(t,e){var s,i,a,o,h=/path|glyph/.test(t.tagName)?t.getTotalLength():n.gL(t);return e instanceof Object?e:("string"==typeof e?(e=e.split(/\,|\s/),s=/%/.test(e[0])?n.pc(e[0].trim(),h):parseFloat(e[0]),i=/%/.test(e[1])?n.pc(e[1].trim(),h):parseFloat(e[1])):"undefined"==typeof e&&(o=parseFloat(r.gCS(t,"stroke-dashoffset")),a=r.gCS(t,"stroke-dasharray").split(/\,/),s=0-o,i=parseFloat(a[0])+s||h),{s:s,e:i,l:h})},n.pc=function(t,e){return parseFloat(t)/100*e},i.draw=function(t,e,r){return"draw"in s||(s.draw=function(t,e,r,n,s){var i=r.l,a=u(r.s,n.s,s),o=u(r.e,n.e,s),h=0-a;t.style.strokeDashoffset=h+"px",t.style.strokeDasharray=o+h<1?"0px, "+i+"px":o+h+"px, "+i+"px"}),n.gDr(r,e)},r.prS.draw=function(t,e,r){return n.gDr(t)},n.gL=function(t){return/rect/.test(t.tagName)?n.gRL(t):/circle/.test(t.tagName)?n.gCL(t):/ellipse/.test(t.tagName)?n.gEL(t):/polygon|polyline/.test(t.tagName)?n.gPL(t):/line/.test(t.tagName)?n.gLL(t):void 0},n.gRL=function(t){var e=t.getAttribute("width"),r=t.getAttribute("height");return 2*e+2*r},n.gPL=function(t){var e=t.getAttribute("points").split(" "),r=0;if(e.length>1){var n=function(t){var e=t.split(",");if(2==e.length&&!isNaN(e[0])&&!isNaN(e[1]))return[parseFloat(e[0]),parseFloat(e[1])]},s=function(t,e){return void 0!=t&&void 0!=e?Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)):0};if(e.length>2)for(var i=0;i<e.length-1;i++)r+=s(n(e[i]),n(e[i+1]));r+=s(n(e[0]),n(e[e.length-1]))}return r},n.gLL=function(t){var e=t.getAttribute("x1"),r=t.getAttribute("x2"),n=t.getAttribute("y1"),s=t.getAttribute("y2");return Math.sqrt(Math.pow(r-e,2)+Math.pow(s-n,2))},n.gCL=function(t){var e=t.getAttribute("r");return 2*Math.PI*e},n.gEL=function(t){var e=t.getAttribute("rx"),r=t.getAttribute("ry"),n=2*e,s=2*r;return Math.sqrt(.5*(n*n+s*s))*(2*Math.PI)/2};for(var v=0,d=p.length;v<d;v++)e=p[v],i[e]=function(t,e){return t in s||(s[t]=function(t,e,r,n,s,i){t.style[e]=f(r,n,s,i.keepHex)}),r.truC(e)},r.prS[e]=function(t,e,n){return r.gCS(t,e)||"rgba(0,0,0,0)"};for(var v=0,d=h.length;v<d;v++)e=h[v],"strokeWidth"===e?i[e]=function(t,e){return t in s||(s[t]=function(t,e,r,n,s){var i=i||"number"==typeof n;t.style[e]=i?u(r,n,s):unit(r.value,n.value,n.unit,s)}),/px|%|em|vh|vw/.test(e)?i.box(t,e):parseFloat(e)}:i[e]=function(t,e){return t in s||(s[t]=function(t,e,r,n,s){t.style[e]=u(r,n,s)}),parseFloat(e)},r.prS[e]=function(t,e,n){return r.gCS(t,e)||0};return i.svgTransform=function(t,e,r){"svgTransform"in s||(s.svgTransform=function(t,e,r,n,s){var i,a="";for(i in n)a+=i+"(","translate"===i?a+=r[i][1]===n[i][1]&&0===n[i][1]?u(r[i][0],n[i][0],s):u(r[i][0],n[i][0],s)+" "+u(r[i][1],n[i][1],s):"rotate"===i?(a+=u(r[i][0],n[i][0],s)+" ",a+=n[i][1]+","+n[i][2]):a+=u(r[i],n[i],s),a+=") ";t.setAttribute("transform",a.trim())});var n,i,a={},o=r.getBBox(),h=o.x+o.width/2,p=o.y+o.height/2;for(v in e)"rotate"===v?(n=e[v]instanceof Array?e[v]:/\s/.test(e[v])?[1*e[v].split(" ")[0],1*e[v].split(" ")[1].split(",")[0],1*e[v].split(" ")[1].split(",")[1]]:[1*e[v],h,p],a[v]=n):"translate"===v?(i=e[v]instanceof Array?e[v]:/\,|\s/.test(e[v])?e[v].split(/\,|\s/):[1*e[v],0],a[v]=[1*i[0]||0,1*i[1]||0]):"scale"===v?a[v]=1*e[v]||1:/skew/.test(v)&&(a[v]=1*e[v]||0);return"scale"in a&&(!("translate"in a)&&(a.translate=[0,0]),a.translate[0]+=(1-a.scale)*o.width/2,a.translate[1]+=(1-a.scale)*o.height/2,"rotate"in a&&(a.rotate[1]-="skewX"in a?Math.tan(a.skewX)*o.height:0,a.rotate[2]-="skewY"in a?Math.tan(a.skewY)*o.width:0),a.translate[0]+="skewX"in a?Math.tan(a.skewX)*o.height*2:0,a.translate[1]+="skewY"in a?Math.tan(a.skewY)*o.width*2:0),a},r.prS.svgTransform=function(t,e,r){var s,i={},a=n.pT(t.getAttribute("transform"));for(s in r)i[s]=s in a?a[s]:"scale"===s?1:0;return i},n.sT=function(t){var e,r,s,i=t._el.getBBox(),a=n.pT(t._el.getAttribute("transform")),o=i.x+i.width/2,h=i.y+i.height/2;for(s in a)"translate"===s?(r=a[s]instanceof Array?a[s]:/\,|\s/.test(a[s])?a[s].split(/\,|\s/):[1*a[s],0],t._vS.svgTransform[s]=[1*r[0]||0,1*r[1]||0]):"scale"===s?t._vS.svgTransform[s]=1*a[s]||1:"rotate"===s?(e=a[s]instanceof Array?a[s]:/\s/.test(a[s])?[1*a[s].split(" ")[0],1*a[s].split(" ")[1].split(",")[0],1*a[s].split(" ")[1].split(",")[1]]:[1*a[s],o,h],t._vS.svgTransform[s]=e):/skew/.test(s)&&(t._vS.svgTransform[s]=1*a[s]||0);for(var s in t._vS.svgTransform)s in t._vE.svgTransform||(t._vE.svgTransform[s]=t._vS.svgTransform[s]),s==="rotate"in t._vS.svgTransform&&"rotate"in t._vE.svgTransform&&(t._vE.svgTransform.rotate[1]=t._vS.svgTransform.rotate[1]=o,t._vE.svgTransform.rotate[2]=t._vS.svgTransform.rotate[2]=h)},n.pT=function(t){var e,r,n=t&&/\)/.test(t)?t.split(")"):"none",s={};if(n instanceof Array)for(e=0;e<n.length;e++)r=n[e].split("("),""!==r[0]&&(s[r[0].replace(/\s/,"")]=r[1]);return s},n}});
